# FPGA_Sokoban / FPGA推箱子
 华南理工大学电子与信息学院2020-2021学年秋季学期《数字系统设计》课程设计


## 简介
### 环境
- 使用`Verilog`语言编写
- 基于ALINX黑金开发板AX4010，芯片型号`Cyclone IV E EP4CF107C8`

### 外设配置
- 显示器采用VGA接口，规格为`640*480@60Hz`
- 方向控制使用电容触摸按键，搭配`TTP223`触摸检测芯片检测按键电平
- 需要使用开发板上的两个轻触按键实现全局复位和当前关卡复位

### 设计
- VGA驱动参照正点原子FPGA教程的VGA部分，显示判断进行了强势魔改
- 游戏主体拥有四个关卡，使用电容触摸按键控制上下左右移动，每个关卡过关后自动进入下一关，同时能进行步数统计，通关后显示结束界面，按下全局复位键重新开始
- 游戏主体依靠8*8“矩阵”实现，矩阵的不同取值代表地图上方格的不同状态
- 游戏操作本质上是对“矩阵”元素的修改，按下按键时可能对应若干种情况，不同情况操作效果不同
- 电容触摸按键的驱动使用了上升沿检测电路，能保证无论每次按下按键多久都只会产生一次脉冲信号，这对游戏至关重要，否则会连续操作
- VGA的规格需要用到25MHz的时钟，我们采用了QuartusII的ip核altpll对开发板时钟进行分频

## 目录结构
- `rtl`： Verilog 源代码
  - `KEY_Driver`： 电容触摸按键驱动
  - `VGA_Driver`： VGA显示驱动
  - `CORE_Gm`： 游戏主体逻辑模块
  - `SOKOBAN`： 顶层实体，实现不同模块的例化和连接
- `dat`： VGA显示使用到的字模文件
- **我们没有把Quartus Project放上来，因此pll模块代码缺失，需要读者自己创建工程设置**

## 敬告
- **不要到了开学ddl了再来嗯抄代码，最好利用假期时间自己动手摸索！** 这个项目花费了我们近两周的时间，从一无所知到2天速成Verilog，再到各种看教程视频查资料，构思代码和debug的过程令我们收获颇多，自己独立完成这个项目能够让你的水平提升一个档次，希望大家只是**参考**这个代码，作业还是尝试独立完成。**劝各位信创的同学做人积极一点！！不要挂着创班的头衔在那里虚度光阴！！连普通班都比不过真的很tm丢脸！！**
- 这个项目有诸多不足，比如显示的图形比较简陋，再如没有关卡选择、悔棋等高级操作，希望后面**参考**的同学能够有所改进


## 作者
华南理工大学电子与信息学院
- 林泽柠 zening.lin@outlook.con
- 李昱澍
- 王庆丰
- 谭启恒